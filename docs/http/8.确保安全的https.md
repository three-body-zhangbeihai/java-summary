

# HTTP的缺**点**
## **HTTP的不足**
>1. 通信使用明文（不加密），内容可能会被窃听
>2. 不验证通信方的身份，因此有可能遭遇伪装
>3. 无法证明报文的完整性，所以有可能已遭篡改
### 其他缺点导致通信不安全
>1. 某些特定的服务器和特定的浏览器有脆弱性或安全漏洞
>2. 用Java和Php等变成语言开发的web应用可能存在安全漏洞
### 通信的明文可能会被窃听
>**HTTP本身不具备加密功能**，无法做到对通信的整体（使用HTTP协议通信的请求和响应的内容）进行加密。所以HTTP是使用**明文方式**发送的。
### **TCP/IP是可能被窃听的网络**
>按TCP/IP协议族的工作机制，通信内容在所有的通信线路上都可能被窃视。即使已经过加密的通信，也会被窃视到**加密后的报文信息。**

       ![图片](https://uploader.shimo.im/f/rSHdou0WFTYcuv3R.png!thumbnail)

                                         （来源：《图解HTTP》）

>**wireshark**（[http://www.wireshark.org/](http://www.wireshark.org/)）就是一款被应用广泛的抓包工具。可以获取HTTP协议的请求和响应内容，并对其进行解析。
## 加密处理防止被窃听
**加密的对象一般有：通信的加密、内容的加密**

1. **通信的加密**
>将 **HTTP **与 **SSL**（Secure Socket Layer，安全套接层）或 **TLS**（Transport Layer Security，安全层传输协议）**组合**使用，加密HTTP的通信。
>用SSL建立**安全通信线路**后，就可以在该线路上进行HTTP通信。**组合的 HTTP** 称为**HTTPS**（HTTP Secure，超文本传输安全协议）或** HTTP over SSL。**

        ![图片](https://uploader.shimo.im/f/NUZV6PSKRr0jJh1B.png!thumbnail)

                                                 （来源：《图解HTTP》）

1. **内容的加密**

对HTTP报文里的内容进行加密处理后再发送请求。

加密内容如下：

**                  **![图片](https://uploader.shimo.im/f/4CFCOyYIRkg0DBeF.png!thumbnail)

                                             （来源：《图解HTTP》）

>对内容加密要求客户端和服务器同时具备**加密**和**解密**机制。
>但内容加密**仍有被篡改的风险**。
## 不验证通信方的身份可能遭遇伪装
>HTTP协议通信时，任何人都可以发起请求，服务只要接到请求，无论对方是谁都会返回响应（发送端IP和端口没被web服务器限定访问的情况下）
1. 基于身份不明的隐患
>① 无法确定真实服务器
>② 无法确定真实客户端
>③无法确定正在通信的客户端是否有权限访问特定的资源
>④无法确定请求来自何方
>⑤无法阻止海量的Dos攻击（Denial of Service，拒绝服务攻击）
>无法证明报文完整性，可能已遭篡改
1. 查明对方的证书
>SSL不仅提供加密处理，还提供一种称为**证书**的手段，可用于确定方。
>证书由**信任的第三方机构**颁发。**伪造证书难**，所以基本上能通过对方持有的证书，判断真实意图

                ![图片](https://uploader.shimo.im/f/x806Ck3T5pQtp0Am.png!thumbnail)


## 无法验证报文的完整性，可能已遭篡改
>**HTTP协议无法证明通信报文的完整性。**
>在通行过程中，可能遭遇“**中间人攻击**”（Man-in-the-Middle attack, MITM）

             ![图片](https://uploader.shimo.im/f/x0S2zIuVebwackR4.png!thumbnail)

>**MD5**（单向函数生成的散列值）**算法生成的散列值 **和 **PGP**（Pretty Good Privacy，完美隐私）**创建的数字签名 **也无法百分百保证安全。因为**MD5和PGP本身被修改**，用户是不能察觉的。
# http+加密+认证+完整性保护 = https
## HTTPS与SSL
>HTTPS并非是应用层的一种新协议。只是HTTP**通信接口部分用SSL**（Secure Socket Layer）和 **TLS**（Transport Layer Security）协议代替而已。
>使用了SSL之后， **HTTP先和SSL通信，再由SSL和TCP通信**。

如图：

                   ![图片](https://uploader.shimo.im/f/4UTJlv4iYNMpC9G5.png!thumbnail)

                                             （来源：《图解HTTP》）


使用SSL后，HTTP就拥有了HTTPS的 **加密**、**证书**和**完整性保护**这些功能。

SSL是**独立**于HTTP的协议，所以运行在应用层的其他协议如 **SMTP **和 **Telnet **等可以**配合SSL**协议使用。SSL是当今世界上最为广泛的网络安全技术。

## HTTPS使用 公开秘钥加密 和 共享秘钥加密 的混合加密方法
### 共享秘钥加密
>共享秘钥加密又叫 **对称秘钥加密**，指**加密和解密同用一个加密方式**。
1. **图示**

**                    **![图片](https://uploader.shimo.im/f/ZqztdJ8vCoAaY0aW.png!thumbnail)

1. **存在的问题**
>发送秘钥有被窃听的风险，不发送又不能解密。

                    ![图片](https://uploader.shimo.im/f/644jBJsrHdQmgYfm.png!thumbnail)


### 公开秘钥加密
>公开秘钥加密又称 **非对称加密**。
>公开秘钥加密使用一对非对称的秘钥。一把叫** 私有秘钥**，一把叫** 公开秘钥**。私有秘钥不能让任何人知道，共有秘钥谁都可以获得。
>发送密文的一方使用对方的公开秘钥进行**加密**，接受者用私钥进行**解密**。
>根据密文和公开秘钥，**恢复原信息非常困难**，所以，安全性高。
1. **图示**

                 ![图片](https://uploader.shimo.im/f/ck41AY3rc8YTqR6n.png!thumbnail)

1. **存在的问题**
>效率比较低
### HTTPS 采用混合加密的方式
>首先：通过**公开秘钥加密**的 方式把**共享秘钥**交换给通信双方。**共享秘钥作为正式通信的秘钥**。
>接着：确保交换的秘钥是安全的前提下，使用**共享秘钥加密**的方式进行通信。
1. **图示：**

                 ![图片](https://uploader.shimo.im/f/0rJMafMcnsEzpZVa.png!thumbnail)


## 证明公开秘钥的正确性的证书
            ![图片](https://uploader.shimo.im/f/JJbMHY2cRj0R9e4k.png!thumbnail)

                                             （来源：《图解HTTP》）


## HTTPS 安全通信机制
**HTTPS的通信步骤：**

![图片](https://uploader.shimo.im/f/pf2AkTg94IovL1CP.png!thumbnail)   ![图片](https://uploader.shimo.im/f/X5kxdVlbeOsbhgWP.png!thumbnail)

                                             （来源：《图解HTTP》）


![图片](https://uploader.shimo.im/f/M3Rd2kgOj1Mg2xDp.png!thumbnail)

                                             （来源：《图解HTTP》）

**参考：《图解HTTP》**

